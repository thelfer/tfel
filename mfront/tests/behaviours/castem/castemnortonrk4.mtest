/*! 
 * \file   castemnortonrk2-rk54.mtest
 * \brief
 * \author Helfer Thomas
 * \brief  09 avril 2013
 */

@ModellingHypothesis 'Axisymmetrical';

@PredictionPolicy 'ElasticPrediction';
@UseCastemAccelerationAlgorithm true;

@Behaviour<umat> @library@ 'umatnortonrk4';
@MaterialProperty<constant> 'YoungModulus'     150.e9;
@MaterialProperty<constant> 'PoissonRatio'       0.3;

@Real 'E' 8.2;
@MaterialProperty<constant> 'E[0]' 'E';
@MaterialProperty<constant> 'E[1]' 'E';
@MaterialProperty<constant> 'E[2]' 'E';
@MaterialProperty<constant> 'E[3]' 'E';
@MaterialProperty<constant> 'E[4]' 'E';
@MaterialProperty<constant> 'E[5]' 'E';
@MaterialProperty<constant> 'E[6]' 'E';
@MaterialProperty<constant> 'E[7]' 'E';
@MaterialProperty<constant> 'E[8]' 'E';
@MaterialProperty<constant> 'E[9]' 'E';
@MaterialProperty<constant> 'E[10]' 'E';
@MaterialProperty<constant> 'E[11]' 'E';
@MaterialProperty<constant> 'E[12]' 'E';
@MaterialProperty<constant> 'E[13]' 'E';
@MaterialProperty<constant> 'E[14]' 'E';
@MaterialProperty<constant> 'E[15]' 'E';
@MaterialProperty<constant> 'E[16]' 'E';
@MaterialProperty<constant> 'E[17]' 'E';
@MaterialProperty<constant> 'E[18]' 'E';
@MaterialProperty<constant> 'E[19]' 'E';
@MaterialProperty<constant> 'E[20]' 'E';
@MaterialProperty<constant> 'E[21]' 'E';
@MaterialProperty<constant> 'E[22]' 'E';
@MaterialProperty<constant> 'E[23]' 'E';
@MaterialProperty<constant> 'E[24]' 'E';
@MaterialProperty<constant> 'E[25]' 'E';
@MaterialProperty<constant> 'E[26]' 'E';
@MaterialProperty<constant> 'E[27]' 'E';
@MaterialProperty<constant> 'E[28]' 'E';
@MaterialProperty<constant> 'E[29]' 'E';
@MaterialProperty<constant> 'E[30]' 'E';
@MaterialProperty<constant> 'E[31]' 'E';
@MaterialProperty<constant> 'E[32]' 'E';
@MaterialProperty<constant> 'E[33]' 'E';
@MaterialProperty<constant> 'E[34]' 'E';
@MaterialProperty<constant> 'E[35]' 'E';
@MaterialProperty<constant> 'E[36]' 'E';
@MaterialProperty<constant> 'E[37]' 'E';
@MaterialProperty<constant> 'E[38]' 'E';
@MaterialProperty<constant> 'E[39]' 'E';
@MaterialProperty<constant> 'E[40]' 'E';
@MaterialProperty<constant> 'E[41]' 'E';
@MaterialProperty<constant> 'E[42]' 'E';
@MaterialProperty<constant> 'E[43]' 'E';
@MaterialProperty<constant> 'E[44]' 'E';
@MaterialProperty<constant> 'E[45]' 'E';
@MaterialProperty<constant> 'E[46]' 'E';
@MaterialProperty<constant> 'E[47]' 'E';
@MaterialProperty<constant> 'E[48]' 'E';
@MaterialProperty<constant> 'E[49]' 'E';
@MaterialProperty<constant> 'E[50]' 'E';
@MaterialProperty<constant> 'E[51]' 'E';
@MaterialProperty<constant> 'E[52]' 'E';
@MaterialProperty<constant> 'E[53]' 'E';
@MaterialProperty<constant> 'E[54]' 'E';
@MaterialProperty<constant> 'E[55]' 'E';
@MaterialProperty<constant> 'E[56]' 'E';
@MaterialProperty<constant> 'E[57]' 'E';
@MaterialProperty<constant> 'E[58]' 'E';
@MaterialProperty<constant> 'E[59]' 'E';
@MaterialProperty<constant> 'E[60]' 'E';
@MaterialProperty<constant> 'E[61]' 'E';
@MaterialProperty<constant> 'E[62]' 'E';
@MaterialProperty<constant> 'E[63]' 'E';
@MaterialProperty<constant> 'E[64]' 'E';
@MaterialProperty<constant> 'E[65]' 'E';
@MaterialProperty<constant> 'E[66]' 'E';
@MaterialProperty<constant> 'E[67]' 'E';
@MaterialProperty<constant> 'E[68]' 'E';
@MaterialProperty<constant> 'E[69]' 'E';
@MaterialProperty<constant> 'E[70]' 'E';
@MaterialProperty<constant> 'E[71]' 'E';
@MaterialProperty<constant> 'E[72]' 'E';
@MaterialProperty<constant> 'E[73]' 'E';
@MaterialProperty<constant> 'E[74]' 'E';
@MaterialProperty<constant> 'E[75]' 'E';
@MaterialProperty<constant> 'E[76]' 'E';
@MaterialProperty<constant> 'E[77]' 'E';
@MaterialProperty<constant> 'E[78]' 'E';
@MaterialProperty<constant> 'E[79]' 'E';
@MaterialProperty<constant> 'E[80]' 'E';
@MaterialProperty<constant> 'E[81]' 'E';
@MaterialProperty<constant> 'E[82]' 'E';
@MaterialProperty<constant> 'E[83]' 'E';
@MaterialProperty<constant> 'E[84]' 'E';
@MaterialProperty<constant> 'E[85]' 'E';
@MaterialProperty<constant> 'E[86]' 'E';
@MaterialProperty<constant> 'E[87]' 'E';
@MaterialProperty<constant> 'E[88]' 'E';
@MaterialProperty<constant> 'E[89]' 'E';
@MaterialProperty<constant> 'E[90]' 'E';
@MaterialProperty<constant> 'E[91]' 'E';
@MaterialProperty<constant> 'E[92]' 'E';
@MaterialProperty<constant> 'E[93]' 'E';
@MaterialProperty<constant> 'E[94]' 'E';
@MaterialProperty<constant> 'E[95]' 'E';
@MaterialProperty<constant> 'E[96]' 'E';
@MaterialProperty<constant> 'E[97]' 'E';
@MaterialProperty<constant> 'E[98]' 'E';
@MaterialProperty<constant> 'E[99]' 'E';

@Real 'srr' 20.e6;
@ImposedStress 'SRR' 'srr';
// Initial value of the elastic strain
@Real 'EELRR0' 0.00013333333333333333;
@Real 'EELZZ0' -0.00004;
@InternalStateVariable 'ElasticStrain' {'EELRR0','EELZZ0','EELZZ0',0.};
// Initial value of the total strain
@Strain {'EELRR0','EELZZ0','EELZZ0',0.};
// Initial value of the stresses
@Stress {'srr',0.,0.,0.};

@ExternalStateVariable 'Temperature' 293.15;
@Real 'A' 8.e-67;
@ExternalStateVariable 'A[0]' 'A/100';
@ExternalStateVariable 'A[1]' 'A/100';
@ExternalStateVariable 'A[2]' 'A/100';
@ExternalStateVariable 'A[3]' 'A/100';
@ExternalStateVariable 'A[4]' 'A/100';
@ExternalStateVariable 'A[5]' 'A/100';
@ExternalStateVariable 'A[6]' 'A/100';
@ExternalStateVariable 'A[7]' 'A/100';
@ExternalStateVariable 'A[8]' 'A/100';
@ExternalStateVariable 'A[9]' 'A/100';
@ExternalStateVariable 'A[10]' 'A/100';
@ExternalStateVariable 'A[11]' 'A/100';
@ExternalStateVariable 'A[12]' 'A/100';
@ExternalStateVariable 'A[13]' 'A/100';
@ExternalStateVariable 'A[14]' 'A/100';
@ExternalStateVariable 'A[15]' 'A/100';
@ExternalStateVariable 'A[16]' 'A/100';
@ExternalStateVariable 'A[17]' 'A/100';
@ExternalStateVariable 'A[18]' 'A/100';
@ExternalStateVariable 'A[19]' 'A/100';
@ExternalStateVariable 'A[20]' 'A/100';
@ExternalStateVariable 'A[21]' 'A/100';
@ExternalStateVariable 'A[22]' 'A/100';
@ExternalStateVariable 'A[23]' 'A/100';
@ExternalStateVariable 'A[24]' 'A/100';
@ExternalStateVariable 'A[25]' 'A/100';
@ExternalStateVariable 'A[26]' 'A/100';
@ExternalStateVariable 'A[27]' 'A/100';
@ExternalStateVariable 'A[28]' 'A/100';
@ExternalStateVariable 'A[29]' 'A/100';
@ExternalStateVariable 'A[30]' 'A/100';
@ExternalStateVariable 'A[31]' 'A/100';
@ExternalStateVariable 'A[32]' 'A/100';
@ExternalStateVariable 'A[33]' 'A/100';
@ExternalStateVariable 'A[34]' 'A/100';
@ExternalStateVariable 'A[35]' 'A/100';
@ExternalStateVariable 'A[36]' 'A/100';
@ExternalStateVariable 'A[37]' 'A/100';
@ExternalStateVariable 'A[38]' 'A/100';
@ExternalStateVariable 'A[39]' 'A/100';
@ExternalStateVariable 'A[40]' 'A/100';
@ExternalStateVariable 'A[41]' 'A/100';
@ExternalStateVariable 'A[42]' 'A/100';
@ExternalStateVariable 'A[43]' 'A/100';
@ExternalStateVariable 'A[44]' 'A/100';
@ExternalStateVariable 'A[45]' 'A/100';
@ExternalStateVariable 'A[46]' 'A/100';
@ExternalStateVariable 'A[47]' 'A/100';
@ExternalStateVariable 'A[48]' 'A/100';
@ExternalStateVariable 'A[49]' 'A/100';
@ExternalStateVariable 'A[50]' 'A/100';
@ExternalStateVariable 'A[51]' 'A/100';
@ExternalStateVariable 'A[52]' 'A/100';
@ExternalStateVariable 'A[53]' 'A/100';
@ExternalStateVariable 'A[54]' 'A/100';
@ExternalStateVariable 'A[55]' 'A/100';
@ExternalStateVariable 'A[56]' 'A/100';
@ExternalStateVariable 'A[57]' 'A/100';
@ExternalStateVariable 'A[58]' 'A/100';
@ExternalStateVariable 'A[59]' 'A/100';
@ExternalStateVariable 'A[60]' 'A/100';
@ExternalStateVariable 'A[61]' 'A/100';
@ExternalStateVariable 'A[62]' 'A/100';
@ExternalStateVariable 'A[63]' 'A/100';
@ExternalStateVariable 'A[64]' 'A/100';
@ExternalStateVariable 'A[65]' 'A/100';
@ExternalStateVariable 'A[66]' 'A/100';
@ExternalStateVariable 'A[67]' 'A/100';
@ExternalStateVariable 'A[68]' 'A/100';
@ExternalStateVariable 'A[69]' 'A/100';
@ExternalStateVariable 'A[70]' 'A/100';
@ExternalStateVariable 'A[71]' 'A/100';
@ExternalStateVariable 'A[72]' 'A/100';
@ExternalStateVariable 'A[73]' 'A/100';
@ExternalStateVariable 'A[74]' 'A/100';
@ExternalStateVariable 'A[75]' 'A/100';
@ExternalStateVariable 'A[76]' 'A/100';
@ExternalStateVariable 'A[77]' 'A/100';
@ExternalStateVariable 'A[78]' 'A/100';
@ExternalStateVariable 'A[79]' 'A/100';
@ExternalStateVariable 'A[80]' 'A/100';
@ExternalStateVariable 'A[81]' 'A/100';
@ExternalStateVariable 'A[82]' 'A/100';
@ExternalStateVariable 'A[83]' 'A/100';
@ExternalStateVariable 'A[84]' 'A/100';
@ExternalStateVariable 'A[85]' 'A/100';
@ExternalStateVariable 'A[86]' 'A/100';
@ExternalStateVariable 'A[87]' 'A/100';
@ExternalStateVariable 'A[88]' 'A/100';
@ExternalStateVariable 'A[89]' 'A/100';
@ExternalStateVariable 'A[90]' 'A/100';
@ExternalStateVariable 'A[91]' 'A/100';
@ExternalStateVariable 'A[92]' 'A/100';
@ExternalStateVariable 'A[93]' 'A/100';
@ExternalStateVariable 'A[94]' 'A/100';
@ExternalStateVariable 'A[95]' 'A/100';
@ExternalStateVariable 'A[96]' 'A/100';
@ExternalStateVariable 'A[97]' 'A/100';
@ExternalStateVariable 'A[98]' 'A/100';
@ExternalStateVariable 'A[99]' 'A/100';

@Real 'tmax' 2500;
@Times {0.,100. in 100, 'tmax' in 1000};

// tests on strains
// note: EquivalentViscoplasticStrain is known at 1.e-12 (defaut value
// for @StrainEpsilon), thus we may expect the strain to be known at
// '3.6*1.e-9'. If pratice, things are a bit better but not much
// better.
@Test<function> 'ERR' 'EELRR0+A*SRR**E*t'     1.e-9;
@Test<function> 'EZZ' 'EELZZ0-0.5*A*SRR**E*t' 1.e-10;
@Test<function> 'ETT' 'EELZZ0-0.5*A*SRR**E*t' 1.e-10;
@Test<function> 'ERZ' '0.'                    1.e-10;
// tests on internal state variables
@Test<function> 'ElasticStrainRR' 'EELRR0'  1.e-12;
@Test<function> 'ElasticStrainZZ' 'EELZZ0'  1.e-12;
@Test<function> 'ElasticStrainTT' 'EELZZ0'  1.e-12;
@Test<function> 'ElasticStrainRZ' '0.'      1.e-12;
